<#list metadata.foreignTable.columns as column><#if column.name?lower_case == metadata.localTable.name?lower_case><#assign localTable=column.foreignReference.table /><#assign localColumn=column /><#else><#assign foreignTable=column.foreignReference.table /><#assign foreignColumn=column /></#if></#list>SELECT * FROM ${qualify(foreignTable)} JOIN ${qualify(table)} ON (<#list foreignTable.primaryKey.columns as column>${qualify(column)}</#list> = ${qualify(foreignColumn)}) WHERE ${qualify(localColumn)} = <#list localTable.primaryKey.columns as column>${value[column.name]}</#list><#if metadata.ordering?? && metadata.ordering?size &gt; 0> ORDER BY <#list metadata.ordering as ordering>${qualify(ordering.column)} ${ordering.order}<#if ordering_has_next>, </#if></#list></#if>;